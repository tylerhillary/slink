[debug] [2026-01-28T17:32:24.601Z] ----------------------------------------------------------------------
[debug] [2026-01-28T17:32:24.605Z] Command:       C:\Program Files\nodejs\node.exe C:\Users\tyler\AppData\Roaming\npm\node_modules\firebase-tools\lib\bin\firebase.js deploy --only firestore:rules
[debug] [2026-01-28T17:32:24.605Z] CLI Version:   15.4.0
[debug] [2026-01-28T17:32:24.605Z] Platform:      win32
[debug] [2026-01-28T17:32:24.605Z] Node Version:  v22.17.0
[debug] [2026-01-28T17:32:24.606Z] Time:          Wed Jan 28 2026 18:32:24 GMT+0100 (West Africa Standard Time)
[debug] [2026-01-28T17:32:24.606Z] ----------------------------------------------------------------------
[debug] 
[debug] [2026-01-28T17:32:26.774Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2026-01-28T17:32:26.774Z] > authorizing via signed-in user (tylerhillary03@gmail.com)
[debug] [2026-01-28T17:32:26.774Z] [iam] checking project slink-website for permissions ["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]
[debug] [2026-01-28T17:32:26.776Z] Checked if tokens are valid: false, expires at: 1769617381457
[debug] [2026-01-28T17:32:26.776Z] Checked if tokens are valid: false, expires at: 1769617381457
[debug] [2026-01-28T17:32:26.776Z] > refreshing access token with scopes: []
[debug] [2026-01-28T17:32:26.778Z] >>> [apiv2][query] POST https://www.googleapis.com/oauth2/v3/token [none]
[debug] [2026-01-28T17:32:26.778Z] >>> [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2026-01-28T17:32:29.154Z] <<< [apiv2][status] POST https://www.googleapis.com/oauth2/v3/token 200
[debug] [2026-01-28T17:32:29.154Z] <<< [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2026-01-28T17:32:29.174Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/slink-website:testIamPermissions [none]
[debug] [2026-01-28T17:32:29.174Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/slink-website:testIamPermissions x-goog-quota-user=projects/slink-website
[debug] [2026-01-28T17:32:29.174Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/slink-website:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[debug] [2026-01-28T17:32:37.615Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/slink-website:testIamPermissions 200
[debug] [2026-01-28T17:32:37.616Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/slink-website:testIamPermissions {"permissions":["datastore.indexes.create","datastore.indexes.delete","datastore.indexes.list","datastore.indexes.update","firebase.projects.get"]}
[info] 
[info] === Deploying to 'slink-website'...
[info] 
[info] i  deploying firestore 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[info] i  firestore: ensuring required API firestore.googleapis.com is enabled... 
[debug] [2026-01-28T17:32:37.622Z] Checked if tokens are valid: true, expires at: 1769625148154
[debug] [2026-01-28T17:32:37.622Z] Checked if tokens are valid: true, expires at: 1769625148154
[debug] [2026-01-28T17:32:37.623Z] >>> [apiv2][query] GET https://firestore.googleapis.com/v1/projects/slink-website/databases/(default) [none]
[debug] [2026-01-28T17:32:39.889Z] <<< [apiv2][status] GET https://firestore.googleapis.com/v1/projects/slink-website/databases/(default) 200
[debug] [2026-01-28T17:32:39.889Z] <<< [apiv2][body] GET https://firestore.googleapis.com/v1/projects/slink-website/databases/(default) {"name":"projects/slink-website/databases/(default)","uid":"406efa27-e620-48f1-b602-1e0b70c7334b","createTime":"2026-01-11T23:20:14.503936Z","updateTime":"2026-01-11T23:20:14.503936Z","locationId":"africa-south1","type":"FIRESTORE_NATIVE","concurrencyMode":"PESSIMISTIC","versionRetentionPeriod":"3600s","earliestVersionTime":"2026-01-28T16:32:40.237072Z","appEngineIntegrationMode":"DISABLED","pointInTimeRecoveryEnablement":"POINT_IN_TIME_RECOVERY_DISABLED","deleteProtectionState":"DELETE_PROTECTION_DISABLED","databaseEdition":"STANDARD","freeTier":true,"realtimeUpdatesMode":"REALTIME_UPDATES_MODE_ENABLED","etag":"II6y8IPirpIDMPXXh5zRhJID"}
[info] i  firestore: reading indexes from firestore.indexes.json... 
[info] i  cloud.firestore: checking firestore.rules for compilation errors... 
[debug] [2026-01-28T17:32:39.892Z] Checked if tokens are valid: true, expires at: 1769625148154
[debug] [2026-01-28T17:32:39.892Z] Checked if tokens are valid: true, expires at: 1769625148154
[debug] [2026-01-28T17:32:39.892Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/slink-website:test [none]
[debug] [2026-01-28T17:32:39.892Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/slink-website:test [omitted]
[debug] [2026-01-28T17:32:41.546Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/slink-website:test 200
[debug] [2026-01-28T17:32:41.546Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/slink-website:test {"issues":[{"sourcePosition":{"fileName":"firestore.rules","line":18,"column":14,"currentOffset":419,"endOffset":437},"description":"Unused function: isOptionalTimestamp.","severity":"WARNING"},{"sourcePosition":{"fileName":"firestore.rules","line":59,"column":14,"currentOffset":2151,"endOffset":2176},"description":"Unused function: isPublicRegistrationCreate.","severity":"WARNING"},{"sourcePosition":{"fileName":"firestore.rules","line":60,"column":18,"currentOffset":2200,"endOffset":2206},"description":"Invalid variable name: request.","severity":"WARNING"}]}
[warn] !  [W] 18:14 - Unused function: isOptionalTimestamp. 
[warn] !  [W] 59:14 - Unused function: isPublicRegistrationCreate. 
[warn] !  [W] 60:18 - Invalid variable name: request. 
[info] +  cloud.firestore: rules file firestore.rules compiled successfully 
[debug] [2026-01-28T17:32:41.551Z] Checked if tokens are valid: true, expires at: 1769625148154
[debug] [2026-01-28T17:32:41.551Z] Checked if tokens are valid: true, expires at: 1769625148154
[debug] [2026-01-28T17:32:41.552Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/slink-website/releases pageSize=10&pageToken=
[debug] [2026-01-28T17:32:42.421Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/slink-website/releases 200
[debug] [2026-01-28T17:32:42.422Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/slink-website/releases {"releases":[{"name":"projects/slink-website/releases/cloud.firestore","rulesetName":"projects/slink-website/rulesets/28ffbed8-2089-4a5a-b320-7d04cb14da30","createTime":"2026-01-11T23:20:21.268919Z","updateTime":"2026-01-28T16:56:13.613546Z"}]}
[debug] [2026-01-28T17:32:42.422Z] Checked if tokens are valid: true, expires at: 1769625148154
[debug] [2026-01-28T17:32:42.422Z] Checked if tokens are valid: true, expires at: 1769625148154
[debug] [2026-01-28T17:32:42.423Z] >>> [apiv2][query] GET https://firebaserules.googleapis.com/v1/projects/slink-website/rulesets/28ffbed8-2089-4a5a-b320-7d04cb14da30 [none]
[debug] [2026-01-28T17:32:44.037Z] <<< [apiv2][status] GET https://firebaserules.googleapis.com/v1/projects/slink-website/rulesets/28ffbed8-2089-4a5a-b320-7d04cb14da30 200
[debug] [2026-01-28T17:32:44.037Z] <<< [apiv2][body] GET https://firebaserules.googleapis.com/v1/projects/slink-website/rulesets/28ffbed8-2089-4a5a-b320-7d04cb14da30 [omitted]
[info] i  firestore: uploading rules firestore.rules... 
[debug] [2026-01-28T17:32:44.041Z] Checked if tokens are valid: true, expires at: 1769625148154
[debug] [2026-01-28T17:32:44.041Z] Checked if tokens are valid: true, expires at: 1769625148154
[debug] [2026-01-28T17:32:44.042Z] >>> [apiv2][query] POST https://firebaserules.googleapis.com/v1/projects/slink-website/rulesets [none]
[debug] [2026-01-28T17:32:44.042Z] >>> [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/slink-website/rulesets [omitted]
[debug] [2026-01-28T17:32:45.477Z] <<< [apiv2][status] POST https://firebaserules.googleapis.com/v1/projects/slink-website/rulesets 200
[debug] [2026-01-28T17:32:45.478Z] <<< [apiv2][body] POST https://firebaserules.googleapis.com/v1/projects/slink-website/rulesets {"name":"projects/slink-website/rulesets/b9c7d48e-30fb-4b46-8094-3e6cc1b9fa97","source":{"files":[{"content":"rules_version = '2';\r\n\r\nservice cloud.firestore {\r\n  match /databases/{database}/documents {\r\n\r\n    function isNonEmptyString(value) {\r\n      return value is string && value.size() > 0;\r\n    }\r\n\r\n    function isOptionalNonEmptyString(value) {\r\n      return value == null || isNonEmptyString(value);\r\n    }\r\n\r\n    function isOptionalString(value) {\r\n      return value == null || value is string;\r\n    }\r\n\r\n    function isOptionalTimestamp(value) {\r\n      return value == null || value is timestamp;\r\n    }\r\n\r\n    function isTimestampOrServer(value) {\r\n      return value is timestamp || value == request.time || value is map;\r\n    }\r\n\r\n    function isNonEmptyStringList(list) {\r\n      return list is list && list.size() > 0 && list.size() <= 50 && list[0] is string;\r\n    }\r\n\r\n    function isOptionalStringList(list) {\r\n      return list == null || (list is list && (list.size() == 0 || list[0] is string));\r\n    }\r\n\r\n    function hasValidPhoneDetails(details) {\r\n      return details == null || (\r\n        details is map &&\r\n        details.keys().hasOnly(['e164', 'countryCode', 'nationalNumber', 'rawInput', 'international', 'display']) &&\r\n        isOptionalNonEmptyString(details.e164) &&\r\n        isOptionalNonEmptyString(details.countryCode) &&\r\n        isOptionalNonEmptyString(details.nationalNumber) &&\r\n        isOptionalString(details.rawInput) &&\r\n        isOptionalNonEmptyString(details.international) &&\r\n        isOptionalNonEmptyString(details.display)\r\n      );\r\n    }\r\n\r\n    function hasValidTeacherNotification(notification) {\r\n      return notification == null || (\r\n        notification is map &&\r\n        notification.keys().hasOnly(['status', 'createdAt', 'updatedAt', 'lastAttemptedAt', 'lastError']) &&\r\n        isNonEmptyString(notification.status) &&\r\n        (notification.createdAt == null || isTimestampOrServer(notification.createdAt)) &&\r\n        (notification.updatedAt == null || isTimestampOrServer(notification.updatedAt)) &&\r\n        (notification.lastAttemptedAt == null || isTimestampOrServer(notification.lastAttemptedAt)) &&\r\n        isOptionalString(notification.lastError)\r\n      );\r\n    }\r\n\r\n    function isPublicRegistrationCreate() {\r\n      let data = request.resource.data;\r\n      return data.keys().hasOnly([\r\n          'fullName',\r\n          'email',\r\n          'age',\r\n          'gender',\r\n          'location',\r\n          'selectedSkill',\r\n          'status',\r\n          'source',\r\n          'consent',\r\n          'createdAt',\r\n          'phone',\r\n          'contactPhone',\r\n          'phoneDetails',\r\n          'teachSkills',\r\n          'teachSkillsIndex',\r\n          'teacherNotification',\r\n          'intent'\r\n        ]) &&\r\n        data.keys().hasAll([\r\n          'fullName',\r\n          'email',\r\n          'age',\r\n          'gender',\r\n          'location',\r\n          'selectedSkill',\r\n          'status',\r\n          'source',\r\n          'consent',\r\n          'teachSkills',\r\n          'intent'\r\n        ]) &&\r\n        isNonEmptyString(data.fullName) &&\r\n        data.fullName.size() >= 3 &&\r\n        isNonEmptyString(data.email) &&\r\n        data.email.size() > 5 &&\r\n        data.age is int && data.age >= 13 && data.age <= 100 &&\r\n        isNonEmptyString(data.gender) &&\r\n        isNonEmptyString(data.location) &&\r\n        isNonEmptyString(data.selectedSkill) &&\r\n        data.status in ['pending', 'matched', 'archived'] &&\r\n        isNonEmptyString(data.source) &&\r\n        data.consent == true &&\r\n        (data.createdAt == null || isTimestampOrServer(data.createdAt)) &&\r\n        isOptionalNonEmptyString(data.phone) &&\r\n        isOptionalNonEmptyString(data.contactPhone) &&\r\n        isNonEmptyStringList(data.teachSkills) &&\r\n        isOptionalStringList(data.teachSkillsIndex) &&\r\n        data.intent in ['learn', 'teach', 'both'] &&\r\n        hasValidPhoneDetails(data.phoneDetails) &&\r\n        hasValidTeacherNotification(data.teacherNotification);\r\n    }\r\n\r\n    match /registrations/{registrationId} {\r\n      allow create, read, update, delete: if true;\r\n    }\r\n\r\n    match /submissions/{submissionId} {\r\n      allow create, read, update, delete: if true;\r\n    }\r\n\r\n    match /mailQueue/{mailId} {\r\n      allow create, read, update, delete: if true;\r\n    }\r\n\r\n    function isValidSkillCreate() {\r\n      let data = request.resource.data;\r\n      return request.auth == null &&\r\n        data.keys().hasOnly(['name', 'icon', 'description', 'status', 'nameLower', 'createdAt']) &&\r\n        data.keys().hasAll(['name', 'status', 'nameLower']) &&\r\n        isNonEmptyString(data.name) &&\r\n        isOptionalString(data.icon) &&\r\n        isOptionalString(data.description) &&\r\n        isNonEmptyString(data.status) &&\r\n        isNonEmptyString(data.nameLower) &&\r\n        (data.createdAt == null || isTimestampOrServer(data.createdAt));\r\n    }\r\n\r\n    match /skills/{skillId} {\r\n      allow read: if true;\r\n      allow create: if isValidSkillCreate();\r\n      allow update, delete: if false;\r\n    }\r\n\r\n    function isValidContactSubmission() {\r\n      let data = request.resource.data;\r\n      return data.keys().hasOnly(['name', 'email', 'phone', 'topic', 'subject', 'message', 'timestamp']) &&\r\n        data.keys().hasAll(['name', 'email', 'topic', 'subject', 'message', 'timestamp']) &&\r\n        isNonEmptyString(data.name) &&\r\n        data.name.size() >= 3 &&\r\n        isNonEmptyString(data.email) &&\r\n        data.email.size() > 5 &&\r\n        isNonEmptyString(data.topic) &&\r\n        isNonEmptyString(data.subject) &&\r\n        isNonEmptyString(data.message) &&\r\n        isOptionalString(data.phone) &&\r\n        isTimestampOrServer(data.timestamp);\r\n    }\r\n\r\n    match /contactSubmissions/{submissionId} {\r\n      allow create: if isValidContactSubmission();\r\n      allow read, update, delete: if false;\r\n    }\r\n\r\n    match /teachers/{teacherId} {\r\n      allow read: if true;\r\n      allow write: if false;\r\n    }\r\n\r\n    match /{document=**} {\r\n      allow read, write: if request.auth != null && request.auth.token.admin == true;\r\n    }\r\n  }\r\n}\r\n","name":"firestore.rules"}]},"createTime":"2026-01-28T17:32:45.500383Z","metadata":{"services":["cloud.firestore"]}}
[debug] [2026-01-28T17:32:45.478Z] [rules] created ruleset projects/slink-website/rulesets/b9c7d48e-30fb-4b46-8094-3e6cc1b9fa97
[debug] [2026-01-28T17:32:45.478Z] [rules] releasing cloud.firestore/(default) with ruleset projects/slink-website/rulesets/b9c7d48e-30fb-4b46-8094-3e6cc1b9fa97
[debug] [2026-01-28T17:32:45.478Z] Checked if tokens are valid: true, expires at: 1769625148154
[debug] [2026-01-28T17:32:45.478Z] Checked if tokens are valid: true, expires at: 1769625148154
[debug] [2026-01-28T17:32:45.478Z] >>> [apiv2][query] PATCH https://firebaserules.googleapis.com/v1/projects/slink-website/releases/cloud.firestore/(default) [none]
[debug] [2026-01-28T17:32:45.479Z] >>> [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/slink-website/releases/cloud.firestore/(default) {"release":{"name":"projects/slink-website/releases/cloud.firestore/(default)","rulesetName":"projects/slink-website/rulesets/b9c7d48e-30fb-4b46-8094-3e6cc1b9fa97"}}
[debug] [2026-01-28T17:32:47.106Z] <<< [apiv2][status] PATCH https://firebaserules.googleapis.com/v1/projects/slink-website/releases/cloud.firestore/(default) 200
[debug] [2026-01-28T17:32:47.107Z] <<< [apiv2][body] PATCH https://firebaserules.googleapis.com/v1/projects/slink-website/releases/cloud.firestore/(default) {"name":"projects/slink-website/releases/cloud.firestore","rulesetName":"projects/slink-website/rulesets/b9c7d48e-30fb-4b46-8094-3e6cc1b9fa97","createTime":"2026-01-11T23:20:21.268919Z","updateTime":"2026-01-28T17:32:46.947705Z"}
[debug] [2026-01-28T17:32:47.107Z] [rules] updated release projects/slink-website/releases/cloud.firestore
[info] +  firestore: released rules firestore.rules to cloud.firestore 
[info] 
[info] +  Deploy complete! 
[info] 
[info] Project Console: https://console.firebase.google.com/project/slink-website/overview
[debug] [2026-01-28T17:32:52.408Z] Error: Timed out.
    at Timeout._onTimeout (C:\Users\tyler\AppData\Roaming\npm\node_modules\firebase-tools\lib\utils.js:308:49)
    at listOnTimeout (node:internal/timers:588:17)
    at process.processTimers (node:internal/timers:523:7)
[error] 
[error] Error: An unexpected error has occurred.
